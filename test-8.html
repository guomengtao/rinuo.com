<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dev Tools Catalog</title>
  <!-- 引入Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- 引入Font Awesome图标 -->
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  
  <!-- 自定义Tailwind配置 -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#3B82F6',
            secondary: '#10B981',
            dark: '#1E293B',
            light: '#F8FAFC'
          },
          fontFamily: {
            inter: ['Inter', 'system-ui', 'sans-serif'],
          },
        },
      }
    }
  </script>
  
  <!-- 自定义工具类 -->
  <style type="text/tailwindcss">
    @layer utilities {
      .category-row {
        @apply grid grid-cols-1 md:grid-cols-4 gap-4 p-4 border-b border-gray-100 hover:bg-gray-50 transition-colors;
      }
      .category-name {
        @apply font-semibold text-gray-800 cursor-pointer hover:text-primary transition-colors;
      }
      .tag-item {
        @apply inline-flex items-center px-3 py-1 rounded-full text-sm font-medium cursor-pointer transition-all duration-200;
      }
      .tag-item-primary {
        @apply bg-primary/10 text-primary hover:bg-primary/20;
      }
      .tag-item-secondary {
        @apply bg-secondary/10 text-secondary hover:bg-secondary/20;
      }
      .search-results {
        @apply bg-white rounded-xl shadow-sm p-6 mt-6;
      }
    }
  </style>
</head>
<body class="font-inter bg-gray-50 text-dark min-h-screen">
  <!-- 页面头部 -->
  <header class="bg-white shadow-sm sticky top-0 z-50">
    <div class="container mx-auto px-4 py-6">
      <h1 class="text-[clamp(1.5rem,3vw,2.5rem)] font-bold text-primary">
        <i class="fa fa-wrench mr-3"></i>Dev Tools Catalog
      </h1>
      <p class="text-gray-600 mt-1">Browse development tools by category and tags</p>
      
      <!-- 搜索框 -->
      <div class="relative mt-4 w-full max-w-2xl">
        <input type="text" id="search-input" 
               class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary"
               placeholder="Search by tag or tool...">
        <button id="clear-search" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors hidden">
          <i class="fa fa-times"></i>
        </button>
      </div>
    </div>
  </header>

  <!-- 主要内容区 -->
  <main class="container mx-auto px-4 py-8">
    <!-- 分类区域 -->
    <div id="categories-container" class="bg-white rounded-xl shadow-sm overflow-hidden">
      <!-- 分类内容将通过JS动态生成 -->
      <div class="flex justify-center items-center h-32">
        <div class="w-10 h-10 border-4 border-primary border-t-transparent rounded-full animate-spin"></div>
      </div>
    </div>

    <!-- 搜索结果区域 -->
    <div id="search-results-container" class="hidden">
      <div class="search-results">
        <h2 class="text-xl font-bold mb-4">
          Search results for: <span class="text-primary" id="search-term-display"></span>
        </h2>
        <p class="text-gray-600 mb-6" id="results-count"></p>
        
        <div id="search-results-content">
          <!-- 搜索结果内容将通过JS动态生成 -->
        </div>
      </div>
    </div>

    <!-- 工具列表区域 (筛选结果) -->
    <div id="tools-section" class="hidden mt-6">
      <div class="bg-white rounded-xl shadow-sm p-6">
        <h2 class="text-xl font-bold mb-4 flex items-center">
          <i class="fa fa-cubes text-primary mr-2"></i>
          <span>Tools for: <span class="text-primary" id="filter-title"></span></span>
        </h2>
        
        <div id="tools-list" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
          <!-- 工具列表将通过JS动态生成 -->
        </div>
      </div>
    </div>
  </main>

  <!-- 页脚 -->
  <footer class="bg-dark text-white py-8 mt-16">
    <div class="container mx-auto px-4">
      <div class="flex flex-col md:flex-row justify-between items-center">
        <div class="mb-4 md:mb-0">
          <p class="font-bold text-lg">Dev Tools Catalog</p>
          <p class="text-gray-400 text-sm mt-1">A comprehensive collection of development tools</p>
        </div>
        <div class="flex space-x-4">
          <a href="#" class="text-gray-400 hover:text-white transition-colors">
            <i class="fa fa-github text-xl"></i>
          </a>
          <a href="#" class="text-gray-400 hover:text-white transition-colors">
            <i class="fa fa-twitter text-xl"></i>
          </a>
          <a href="#" class="text-gray-400 hover:text-white transition-colors">
            <i class="fa fa-linkedin text-xl"></i>
          </a>
        </div>
      </div>
      <div class="border-t border-gray-700 mt-6 pt-6 text-center text-gray-400 text-sm">
        &copy; 2024 Dev Tools Catalog. All rights reserved.
      </div>
    </div>
  </footer>

  <!-- JavaScript 逻辑 -->
  <script>
    // 全局变量
    let toolsData = [];
    let categories = {}; // 按分类组织的数据 { category: { tags: [], tools: [] } }
    let allTags = new Set();
    
    // DOM 元素
    const categoriesContainer = document.getElementById('categories-container');
    const searchInput = document.getElementById('search-input');
    const clearSearchBtn = document.getElementById('clear-search');
    const searchResultsContainer = document.getElementById('search-results-container');
    const searchTermDisplay = document.getElementById('search-term-display');
    const resultsCount = document.getElementById('results-count');
    const searchResultsContent = document.getElementById('search-results-content');
    const toolsSection = document.getElementById('tools-section');
    const toolsList = document.getElementById('tools-list');
    const filterTitle = document.getElementById('filter-title');

    // 初始化函数
    async function init() {
      try {
        // 加载JSON数据（实际使用时替换为你的JSON文件路径）
        // 这里使用模拟数据加载
        toolsData = await loadToolsData();
        
        // 处理数据
        processData();
        
        // 渲染页面
        renderCategories();
        
      } catch (error) {
        categoriesContainer.innerHTML = `
          <div class="p-6 text-center">
            <i class="fa fa-exclamation-circle text-red-500 text-3xl mb-4"></i>
            <h3 class="text-lg font-semibold text-red-800 mb-2">Error Loading Data</h3>
            <p class="text-red-600">${error.message}</p>
          </div>
        `;
        console.error('Initialization error:', error);
      }
    }

    // 模拟加载工具数据
    async function loadToolsData() {
      // 实际应用中应使用 fetch('tools.json')
      return [
        {"file":"react","name":"React","category":"Frontend","tags":["Framework","JavaScript","UI"]},
        {"file":"vue","name":"Vue","category":"Frontend","tags":["Framework","JavaScript"]},
        {"file":"svelte","name":"Svelte","category":"Frontend","tags":["Framework","JavaScript"]},
        {"file":"nextjs","name":"Nextjs","category":"Frontend","tags":["Framework","JavaScript","Fullstack"]},
        {"file":"flutter","name":"Flutter","category":"Frontend","tags":["Framework","Mobile Development","UI"]},
        {"file":"expo","name":"Expo","category":"Frontend","tags":["Mobile Development","Framework","JavaScript"]},
        {"file":"bootstrap","name":"Bootstrap","category":"Frontend","tags":["UI Framework","CSS"]},
        {"file":"tailwind","name":"Tailwind","category":"Frontend","tags":["UI Framework","CSS Tools"]},
        {"file":"layui","name":"Layui","category":"Frontend","tags":["UI Framework","CSS"]},
        {"file":"sass","name":"Sass","category":"Frontend","tags":["CSS Tools","Styling"]},
        {"file":"less","name":"Less","category":"Frontend","tags":["CSS Tools","Styling"]},
        {"file":"postcss","name":"PostCSS","category":"Frontend","tags":["CSS Tools","Build"]},
        {"file":"vite","name":"Vite","category":"Frontend","tags":["Build Tools","JavaScript"]},
        {"file":"jquery","name":"jQuery","category":"Frontend","tags":["JavaScript Library","DOM"]},
        {"file":"d3","name":"D3","category":"Frontend","tags":["JavaScript Library","Charts","Visualization"]},
        {"file":"mocha","name":"Mocha","category":"Testing","tags":["JavaScript","Unit Testing"]},
        {"file":"jest","name":"Jest","category":"Testing","tags":["JavaScript","Unit Testing"]},
        {"file":"vitest","name":"Vitest","category":"Testing","tags":["JavaScript","Unit Testing"]},
        {"file":"reqres","name":"Reqres","category":"Testing","tags":["Mock Data","API"]},
        {"file":"postman","name":"Postman","category":"Tools","tags":["API Testing","Collaboration"]},
        {"file":"swagger","name":"Swagger","category":"Tools","tags":["API Docs","Collaboration"]},
        {"file":"json-placeholder","name":"JSON Placeholder","category":"Tools","tags":["Mock Data","API"]},
        {"file":"mock-api","name":"Mock API","category":"Tools","tags":["Mock Data","API"]},
        {"file":"regex101","name":"Regex101","category":"Tools","tags":["Regex","Testing"]},
        {"file":"express","name":"Express","category":"Backend","tags":["Node.js Framework","API"]},
        {"file":"spring-boot","name":"Spring Boot","category":"Backend","tags":["Java Framework","API"]},
        {"file":"symfony","name":"Symfony","category":"Backend","tags":["PHP Framework","Web App"]},
        {"file":"laravel","name":"Laravel","category":"Backend","tags":["PHP Framework","Web App"]},
        {"file":"wordpress","name":"WordPress","category":"Backend","tags":["CMS","Website"]},
        {"file":"apache","name":"Apache","category":"Backend","tags":["Web Server","Deployment"]},
        {"file":"nginx","name":"Nginx","category":"Backend","tags":["Web Server","Deployment"]},
        {"file":"centos","name":"CentOS","category":"Backend","tags":["Linux Server","Operating System"]},
        {"file":"ubuntu","name":"Ubuntu","category":"Backend","tags":["Linux Server","Operating System"]},
        {"file":"linux","name":"Linux","category":"Backend","tags":["Operating System","Linux"]},
        {"file":"elasticsearch","name":"Elasticsearch","category":"Backend","tags":["Search Engine","Database"]},
        {"file":"firebase","name":"Firebase","category":"Backend","tags":["BaaS","Cloud Service","Database"]},
        {"file":"supabase","name":"Supabase","category":"Backend","tags":["BaaS","API","Database"]},
        {"file":"mysql","name":"MySQL","category":"Database","tags":["SQL","Backend"]},
        {"file":"postgresql","name":"PostgreSQL","category":"Database","tags":["SQL","Backend"]},
        {"file":"sqlite","name":"SQLite","category":"Database","tags":["SQL","Lightweight"]},
        {"file":"mongodb","name":"MongoDB","category":"Database","tags":["NoSQL","Backend"]},
        {"file":"redis","name":"Redis","category":"Database","tags":["Cache","NoSQL"]},
        {"file":"dbeaver","name":"DBeaver","category":"Database","tags":["Management Tool","Visualization"]},
        {"file":"grafana","name":"Grafana","category":"Monitoring","tags":["Visualization","DevOps"]},
        {"file":"prometheus","name":"Prometheus","category":"Monitoring","tags":["Data Collection","DevOps"]},
        {"file":"uptimerobot","name":"UptimeRobot","category":"Monitoring","tags":["DevOps","Uptime"]},
        {"file":"echarts","name":"ECharts","category":"Charts","tags":["Visualization","Frontend"]},
        {"file":"highcharts","name":"Highcharts","category":"Charts","tags":["Visualization","Frontend"]},
        {"file":"chart","name":"Chart","category":"Charts","tags":["Visualization","Frontend"]},
        {"file":"helm","name":"Helm","category":"DevOps","tags":["Container Deployment","Kubernetes"]},
        {"file":"docker","name":"Docker","category":"DevOps","tags":["Container Management","Deployment"]},
        {"file":"kubernetes","name":"Kubernetes","category":"DevOps","tags":["Container Orchestration","Deployment"]},
        {"file":"vercel","name":"Vercel","category":"DevOps","tags":["Cloud Deployment","Frontend"]},
        {"file":"netlify","name":"Netlify","category":"DevOps","tags":["Cloud Deployment","Frontend"]},
        {"file":"render","name":"Render","category":"DevOps","tags":["Cloud Deployment","Fullstack"]},
        {"file":"fly-io","name":"Fly.io","category":"DevOps","tags":["Cloud Deployment","App Hosting"]},
        {"file":"circlecl","name":"CircleCI","category":"DevOps","tags":["CI/CD","Automation"]},
        {"file":"cloudflare","name":"Cloudflare","category":"Networking","tags":["CDN","Security","DevOps"]},
        {"file":"cloudflare-warp","name":"Cloudflare Warp","category":"Networking","tags":["VPN","Security"]},
        {"file":"letsencrypt","name":"Let's Encrypt","category":"Security","tags":["Certificate Management","HTTPS"]},
        {"file":"figma","name":"Figma","category":"Design","tags":["UI","Collaboration","Prototyping"]},
        {"file":"canva","name":"Canva","category":"Design","tags":["UI","Graphics Tool"]},
        {"file":"lottiefiles","name":"LottieFiles","category":"Design","tags":["Animation","Assets"]},
        {"file":"unsplash","name":"Unsplash","category":"Design","tags":["Image Assets","Resources"]},
        {"file":"excalidraw","name":"Excalidraw","category":"Design","tags":["Drawing Tool","Collaboration"]},
        {"file":"notion","name":"Notion","category":"Collaboration","tags":["Notes","Docs","Team"]},
        {"file":"obsidian","name":"Obsidian","category":"Collaboration","tags":["Notes","Knowledge Management"]},
        {"file":"slack","name":"Slack","category":"Collaboration","tags":["Chat Tool","Team"]},
        {"file":"discord","name":"Discord","category":"Collaboration","tags":["Chat Tool","Team"]},
        {"file":"asana","name":"Asana","category":"Collaboration","tags":["Project Management","Team"]},
        {"file":"trello","name":"Trello","category":"Collaboration","tags":["Project Management","Team"]},
        {"file":"zoom","name":"Zoom","category":"Collaboration","tags":["Video Meeting","Multimedia"]},
        {"file":"github","name":"GitHub","category":"Collaboration","tags":["Version Control","Development"]},
        {"file":"bitbucket","name":"Bitbucket","category":"Collaboration","tags":["Version Control","Development"]},
        {"file":"freecodecamp","name":"FreeCodeCamp","category":"Learning","tags":["Coding Practice","Learning"]},
        {"file":"exercism","name":"Exercism","category":"Learning","tags":["Coding Practice","Learning"]},
        {"file":"leetcode","name":"LeetCode","category":"Learning","tags":["Algorithm Practice","Learning"]},
        {"file":"kaggle","name":"Kaggle","category":"Learning","tags":["Data Analysis","AI","Learning"]},
        {"file":"doubao","name":"Doubao","category":"Learning","tags":["Learning Resources","Learning"]},
        {"file":"runway","name":"Runway","category":"AI Tools","tags":["Video Generation","Multimedia"]},
        {"file":"whisper","name":"Whisper","category":"AI Tools","tags":["Speech Recognition","NLP"]},
        {"file":"pytorch","name":"PyTorch","category":"AI Tools","tags":["Framework","Machine Learning"]},
        {"file":"openai","name":"OpenAI","category":"AI Tools","tags":["API","NLP"]},
        {"file":"copilot","name":"Copilot","category":"AI Tools","tags":["Dev Assistance","Code Tools"]},
        {"file":"deepseek","name":"DeepSeek","category":"AI Tools","tags":["Search","Assistance"]},
        {"file":"gradio","name":"Gradio","category":"AI Tools","tags":["Web UI","Prototyping"]},
        {"file":"obs-studio","name":"OBS Studio","category":"Multimedia","tags":["Video Recording","Streaming"]},
        {"file":"unity","name":"Unity","category":"Multimedia","tags":["Game Development","3D"]},
        {"file":"vscode","name":"VSCode","category":"Dev Tools","tags":["IDE","Editor"]},
        {"file":"xcode","name":"Xcode","category":"Dev Tools","tags":["IDE","Mobile Development"]},
        {"file":"replit","name":"Replit","category":"Online Dev","tags":["IDE","Collaboration"]},
        {"file":"cursor","name":"Cursor","category":"Tools","tags":["Dev Assistance","AI Assistance"]},
        {"file":"grammarly","name":"Grammarly","category":"Tools","tags":["Writing Assistance","AI Assistance"]},
        {"file":"prettier","name":"Prettier","category":"Tools","tags":["Code Formatting","Dev Assistance"]},
        {"file":"eslint","name":"ESLint","category":"Tools","tags":["Code Linting","Dev Assistance"]},
        {"file":"npm","name":"NPM","category":"Tools","tags":["Package Manager","JavaScript"]},
        {"file":"pnpm","name":"PNPM","category":"Tools","tags":["Package Manager","JavaScript"]},
        {"file":"yarn","name":"Yarn","category":"Tools","tags":["Package Manager","JavaScript"]},
        {"file":"zapier","name":"Zapier","category":"Tools","tags":["Automation","Collaboration"]},
        {"file":"docusaurus","name":"Docusaurus","category":"Tools","tags":["Docs Generator","Static Site"]},
        {"file":"gmail","name":"Gmail","category":"Tools","tags":["Email","Collaboration"]},
        {"file":"freenom","name":"Freenom","category":"Tools","tags":["Domain Service","Website"]},
        {"file":"7-zip","name":"7-Zip","category":"Tools","tags":["Compression","File Management"]}
      ];
    }

    // 处理数据：按分类组织并提取标签
    function processData() {
      toolsData.forEach(tool => {
        const { category } = tool;
        
        // 如果分类不存在，创建新分类
        if (!categories[category]) {
          categories[category] = {
            tags: new Set(),
            tools: []
          };
        }
        
        // 将工具添加到分类中
        categories[category].tools.push(tool);
        
        // 提取标签并添加到分类的标签集合中
        tool.tags.forEach(tag => {
          categories[category].tags.add(tag);
          allTags.add(tag);
        });
      });
    }

    // 渲染分类和标签
    function renderCategories() {
      // 按分类名称排序
      const sortedCategories = Object.keys(categories).sort();
      
      let html = '';
      
      sortedCategories.forEach(category => {
        const { tags, tools } = categories[category];
        const categoryTags = Array.from(tags);
        
        html += `
          <div class="category-row">
            <!-- 第一列：分类名称 -->
            <div class="col-span-1 flex flex-col justify-center">
              <div class="category-name" data-category="${category}">
                ${category}
              </div>
              <div class="text-sm text-gray-500 mt-1">${tools.length} tools</div>
            </div>
            
            <!-- 第二列：标签 -->
            <div class="col-span-1 md:col-span-3">
              <div class="flex flex-wrap gap-2">
                ${categoryTags.map((tag, index) => `
                  <span class="tag-item ${index % 2 === 0 ? 'tag-item-primary' : 'tag-item-secondary'}" 
                        data-tag="${tag}">
                    ${tag}
                    <span class="ml-1 bg-white/30 text-xs rounded-full px-1.5">
                      ${countToolsWithTag(tag)}
                    </span>
                  </span>
                `).join('')}
              </div>
            </div>
          </div>
        `;
      });
      
      categoriesContainer.innerHTML = html;
      
      // 为分类名称添加点击事件
      document.querySelectorAll('.category-name').forEach(el => {
        el.addEventListener('click', () => {
          const category = el.dataset.category;
          showToolsForCategory(category);
        });
      });
      
      // 为标签添加点击事件
      document.querySelectorAll('.tag-item').forEach(tagEl => {
        tagEl.addEventListener('click', () => {
          const tag = tagEl.dataset.tag;
          showToolsForTag(tag);
        });
      });
    }

    // 计算具有特定标签的工具数量
    function countToolsWithTag(tag) {
      return toolsData.filter(tool => tool.tags.includes(tag)).length;
    }

    // 显示特定标签的工具
    function showToolsForTag(tag) {
      const filteredTools = toolsData.filter(tool => tool.tags.includes(tag));
      displayFilteredTools(filteredTools, tag);
    }

    // 显示特定分类的所有工具
    function showToolsForCategory(category) {
      const filteredTools = categories[category].tools;
      displayFilteredTools(filteredTools, category);
    }

    // 显示筛选后的工具
    function displayFilteredTools(tools, title) {
      // 隐藏其他结果区域
      searchResultsContainer.classList.add('hidden');
      
      // 更新标题
      filterTitle.textContent = title;
      
      // 生成工具列表HTML
      if (tools.length === 0) {
        toolsList.innerHTML = `
          <div class="col-span-full bg-gray-50 rounded-lg p-8 text-center">
            <i class="fa fa-search text-gray-300 text-3xl mb-4"></i>
            <p class="text-gray-500">No tools found matching this criteria</p>
          </div>
        `;
      } else {
        toolsList.innerHTML = tools.map(tool => {
          const toolLink = `/free/detail/${tool.file}`;
          return `
            <div class="bg-gray-50 rounded-lg border border-gray-100 shadow-sm hover:shadow-md transition-shadow p-4">
              <h3 class="font-semibold text-lg mb-2">
                <a href="${toolLink}" class="text-primary hover:underline" target="_blank">
                  ${tool.name}
                </a>
              </h3>
              <div class="flex flex-wrap gap-1.5 mb-3">
                ${tool.tags.map(tag => `
                  <span class="bg-gray-100 text-gray-700 text-xs px-2 py-1 rounded">${tag}</span>
                `).join('')}
              </div>
              <div class="flex items-center text-xs text-gray-500">
                <span class="category-name bg-gray-100 px-2 py-0.5 rounded" data-category="${tool.category}">
                  ${tool.category}
                </span>
              </div>
            </div>
          `;
        }).join('');
        
        // 为工具卡片中的分类名称添加点击事件
        document.querySelectorAll('#tools-list .category-name').forEach(el => {
          el.addEventListener('click', (e) => {
            e.preventDefault(); // 防止链接跳转
            const category = el.dataset.category;
            showToolsForCategory(category);
          });
        });
      }
      
      // 显示工具区域并滚动到区域顶部
      toolsSection.classList.remove('hidden');
      
      // 关键修复：滚动到结果区域的顶部，确保能看到标题
      setTimeout(() => {
        toolsSection.scrollIntoView({ 
          behavior: 'smooth', 
          block: 'start'  // 滚动到元素顶部
        });
      }, 100);
    }

    // 处理搜索功能
    function handleSearch() {
      const searchTerm = searchInput.value.toLowerCase().trim();
      
      // 显示/隐藏清空按钮
      if (searchTerm) {
        clearSearchBtn.classList.remove('hidden');
      } else {
        clearSearchBtn.classList.add('hidden');
        // 搜索为空时重置显示
        searchResultsContainer.classList.add('hidden');
        toolsSection.classList.add('hidden');
        categoriesContainer.classList.remove('hidden');
        return;
      }
      
      // 隐藏其他区域
      categoriesContainer.classList.add('hidden');
      toolsSection.classList.add('hidden');
      
      // 查找匹配的标签或工具
      const matchedTags = Array.from(allTags).filter(tag => 
        tag.toLowerCase().includes(searchTerm)
      );
      
      const matchedTools = toolsData.filter(tool => 
        tool.name.toLowerCase().includes(searchTerm) ||
        tool.file.toLowerCase().includes(searchTerm) ||
        tool.tags.some(tag => tag.toLowerCase().includes(searchTerm))
      );
      
      // 计算总结果数
      const totalResults = matchedTags.length + matchedTools.length;
      
      // 更新搜索结果显示
      searchTermDisplay.textContent = `"${searchTerm}"`;
      resultsCount.textContent = `Found ${totalResults} result${totalResults !== 1 ? 's' : ''}`;
      
      // 生成搜索结果HTML
      let resultsHtml = '';
      
      if (matchedTags.length > 0) {
        resultsHtml += `
          <div class="mb-6">
            <h3 class="font-semibold text-gray-700 mb-2">Matching Tags</h3>
            <div class="flex flex-wrap gap-2">
              ${matchedTags.map((tag, index) => `
                <span class="tag-item ${index % 2 === 0 ? 'tag-item-primary' : 'tag-item-secondary'}" 
                      data-tag="${tag}">
                  ${tag}
                  <span class="ml-1 bg-white/30 text-xs rounded-full px-1.5">
                    ${countToolsWithTag(tag)}
                  </span>
                </span>
              `).join('')}
            </div>
          </div>
        `;
      }
      
      if (matchedTools.length > 0) {
        resultsHtml += `
          <div>
            <h3 class="font-semibold text-gray-700 mb-2">Matching Tools</h3>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3">
              ${matchedTools.map(tool => {
                const toolLink = `/free/detail/${tool.file}`;
                return `
                  <div class="bg-gray-50 rounded-lg p-3 border border-gray-100 hover:shadow-sm transition-shadow">
                    <h4 class="font-medium">
                      <a href="${toolLink}" class="text-primary hover:underline" target="_blank">
                        ${tool.name}
                      </a>
                    </h4>
                    <p class="text-xs text-gray-500 mt-1">
                      <span class="category-name" data-category="${tool.category}">
                        ${tool.category}
                      </span>
                    </p>
                  </div>
                `;
              }).join('')}
            </div>
          </div>
        `;
      }
      
      if (matchedTags.length === 0 && matchedTools.length === 0) {
        resultsHtml = `
          <div class="bg-gray-50 rounded-lg p-8 text-center">
            <i class="fa fa-search text-gray-300 text-3xl mb-4"></i>
            <h3 class="text-lg font-medium text-gray-700 mb-2">No results found</h3>
            <p class="text-gray-500">Try a different search term</p>
          </div>
        `;
      }
      
      searchResultsContent.innerHTML = resultsHtml;
      
      // 为搜索结果中的标签添加点击事件
      document.querySelectorAll('#search-results-content .tag-item').forEach(tagEl => {
        tagEl.addEventListener('click', () => {
          const tag = tagEl.dataset.tag;
          showToolsForTag(tag);
        });
      });
      
      // 为搜索结果中的分类名称添加点击事件
      document.querySelectorAll('#search-results-content .category-name').forEach(el => {
        el.addEventListener('click', (e) => {
          e.preventDefault(); // 防止链接跳转
          const category = el.dataset.category;
          showToolsForCategory(category);
        });
      });
      
      // 显示搜索结果并滚动到区域顶部
      searchResultsContainer.classList.remove('hidden');
      
      // 关键修复：滚动到搜索结果区域的顶部
      setTimeout(() => {
        searchResultsContainer.scrollIntoView({ 
          behavior: 'smooth', 
          block: 'start'  // 滚动到元素顶部
        });
      }, 100);
    }

    // 清空搜索
    function clearSearch() {
      searchInput.value = '';
      clearSearchBtn.classList.add('hidden');
      searchResultsContainer.classList.add('hidden');
      toolsSection.classList.add('hidden');
      categoriesContainer.classList.remove('hidden');
    }

    // 事件监听
    searchInput.addEventListener('input', handleSearch);
    clearSearchBtn.addEventListener('click', clearSearch);

    // 页面加载完成后初始化
    window.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
    